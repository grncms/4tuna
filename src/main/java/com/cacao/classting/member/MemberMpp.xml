<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cacao.classting.member.MemberMpp">

<resultMap id="resultMapObj" type="com.cacao.classting.member.Member"></resultMap>
	
	<select id="selectOne" resultMap="resultMapObj">
		select
			mmAdminNy
			,mmDormacyNy
			,mmTeacherNy
			,mmGradeCd
			,mmName
			,mmId
			,mmPassword
			,mmPhoneNumber
			,mmGenderCd
			,mmDob
			,mmMemberEmail
			,mmTypeOfLoginCd
			,mmTermsOfserviceNy
			,mmEventNotificationNy
			,mmPersonalInfoNy
			,mmAlarmInvitationNy
			,mmAlarmReplyNy
			,mmDelNy
			,mmDesc
			,modDateTime
			,modDateTimeSvr
			,regDateTime
			,regDateTimeSvr
		FROM	
			Member
		WHERE 1=1
			AND mmSeq = #{mmSeq}
	</select>
	
	<insert id="insert">
		INSERT INTO Member(
			mmAdminNy
			,mmDormacyNy
			,mmTeacherNy
			,mmGradeCd
			,mmName
			,mmId
			,mmPassword
			,mmPhoneNumber
			,mmGenderCd
			,mmDob
			,mmMemberEmail
			,mmTypeOfLoginCd
			,mmTermsOfserviceNy
			,mmEventNotificationNy
			,mmPersonalInfoNy
			,mmDelNy
			,modDateTime
			,modDateTimeSvr
			,regDateTime
			,regDateTimeSvr
		) VALUES (
			0
			,0
			,#{mmTeacherNy}
			,#{mmGradeCd}
			,#{mmName}
			,#{mmId}
			,#{mmPassword}
			,#{mmPhoneNumber}
			,#{mmGenderCd}
			,#{mmDob}
			,#{mmMemberEmail}
			,#{mmTypeOfLoginCd}
			,#{mmTermsOfserviceNy}
			,#{mmEventNotificationNy}
			,#{mmPersonalInfoNy}
			,0
			,#{modDateTime}
			,#{modDateTimeSvr}
			,#{regDateTime}
			,#{regDateTimeSvr}
		)		
	</insert>	
	
	<update id="update">
		UPDATE Member SET 	
			mmTeacherNy = #{mmTeacherNy}
			,mmGradeCd = #{mmGradeCd}
			,mmName = #{mmName}
			,mmId = #{mmId}
			,mmPassword = #{mmPassword}
			,mmPhoneNumber = #{mmPhoneNumber}
			,mmDob = #{mmDob}
			,mmMemberEmail = #{mmMemberEmail}
			,mmDesc = #{mmDesc}
			,mmEventNotificationNy = #{mmEventNotificationNy}
			,mmAlarmInvitationNy = #{mmAlarmInvitationNy}
			,mmAlarmReplyNy = #{mmAlarmReplyNy}
			,modDateTime = #{modDateTime}
			,modDateTimeSvr = #{modDateTimeSvr}
		WHERE 1=1
			AND mmSeq=#{mmSeq}	
	</update>
	
	<select id="selectOneLogin" resultMap="resultMapObj">
		SELECT
			mmSeq
			,mmId
			,mmName
			,mmPassword
			,mmTeacherNy
		FROM
			Member
		WHERE 1=1 
			AND mmId = #{mmId}	
			AND mmPassword = #{mmPassword}	
	</select>
	<select id="selectOneId" resultMap="resultMapObj">
		select
			mmSeq
			,mmName
			,mmId
			,mmPhoneNumber
			,mmDelNy
		FROM	
			Member
		WHERE 1=1
			AND mmSeq = #{mmSeq}
			AND mmName = #{mmName}
			AND mmPhoneNumber = #{mmPhoneNumber}
			AND mmDelNy = 0
	</select>
	<select id="selectOnePassword" resultMap="resultMapObj">
		select
			mmSeq
			,mmName
			,mmId
			,mmPassword
			,mmPhoneNumber
			,mmDelNy
		FROM	
			Member
		WHERE 1=1
			AND mmSeq = #{mmSeq}
			AND mmName = #{mmName}
			AND mmPhoneNumber = #{mmPhoneNumber}
			AND mmId = #{mmId}
			AND mmDelNy = 0
	</select>
	
	
<!-- 	class생성 -->
	<insert id="insertClass">
		INSERT INTO ctClass(
			<!-- ctcsBelongto -->
			ctcsName
			,ctcsYear
			,ctcsGradeCd
			,ctcsDesc
			,ctcsCode
			,ctcsDelNy
			,modDateTime
			,modDateTimeSvr
			,regDateTime
			,regDateTimeSvr
		) VALUES (
			<!-- #{ctcsBelongto} -->
			#{ctcsName}
			,#{ctcsYear}
			,#{ctcsGradeCd}
			,#{ctcsDesc}
			,#{ctcsCode}
			,0
			,#{modDateTime}
			,#{modDateTimeSvr}
			,#{regDateTime}
			,#{regDateTimeSvr}
		)
		<selectKey resultType="String" keyProperty="ctcsSeq" order="AFTER">
			SELECT last_insert_id()
		</selectKey>
	</insert>
		
	<insert id="insertClassMember">
		INSERT INTO ctClassMember(
			ctcmName
			,ctcmAlarmReplyNy
			,ctcmAlarmReactionNy
			,ctcmDelNy
			,mmSeq
			,ctcsSeq
		) VALUES (
			#{ctcmName}
			,0
			,0
			,0
			,#{mmSeq}
			,#{ctcsSeq}
		)	
	</insert>	
	
	<select id="selectOneClass" resultMap="resultMapObj">
		SELECT
			ctcsSeq
			,ctcsName
		FROM
			ctClass
		WHERE 1=1 
			AND ctcsSeq = #{ctcsSeq}	
	</select>
	
	<select id="selectListClass" resultMap="resultMapObj">
		select
			a.ctcmSeq
			,a.ctcmName
			,a.ctcmDelNy
			,b.ctcsYear
			,a.mmSeq
			,a.ctcsSeq
			,b.ctcsName
			,b.ctcsDelNy
		FROM
			ctClassMember a
			LEFT JOIN ctClass b on b.ctcsSeq = a.ctcsSeq
		WHERE 1=1
			AND mmSeq = #{mmSeq}
			AND ctcsDelNy = 0
	</select>
	
</mapper>